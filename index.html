<!DOCTYPE html>
<html>
  <head>
    <script src="js/jquery.js"></script>
    <script src="js/data_generator.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">  
    <link href="css/style.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <script>
      $(document).ready(function(){
        //variables
        var $body = $('body');
        var $myHeader = '<header><h1 id="title">Twittler</h1></header>'
        var $heroImage = '<div class="hero-image"></div>';
        var $mainContent = $myHeader + $heroImage + '<div class="container content-body"><div class="row">';
        var $usernames = [];
        var $listOfTweets = [];
        var $listFollowers = '';

        //HTML Body Structure
        $mainContent += '<div class="col-sm-3 profile"></div>';
        $mainContent += '<div class="col-sm-5 tweets"></div>';
        $mainContent += '<div class="col-sm-4 suggested"></div>';
        $mainContent += '</div></div>';
        $body.html($mainContent);

        //Profile section
        $('<div class="profile-pic"></div').appendTo('.profile');

        //Dislay new Tweets
        function displayTweets() {
          var index = streams.home.length - 1;



        // while(index >= 0){
        var tweet = streams.home[index];
        var $tweet = $('<div class="message"></div>');

        //military time to regular time
        //cleanup excess time items
        var stringTime = '' + tweet.created_at;
        var splitTime = stringTime.split(' ').splice(0, 7);
        var regularTime = splitTime[4].split(':');
        var timePre = regularTime[0];
        var ampm = 'am';
        if(regularTime[0] > 12){
          timePre -= 12;
          ampm = 'pm';
        }
        regularTime = timePre + ':' + regularTime[1] + ':' + regularTime[2] + ampm;
        var timeSyntax = splitTime[0] + ', ' + splitTime[1] + ' ' + splitTime[2] + ', ' + splitTime[3] + ' at ' + regularTime + ' ' + splitTime[6];

        $tweet.fadeIn('slow').html('<a href="#" class="' + tweet.user + '"><strong> @' + tweet.user + '</strong></a>: ' + tweet.message + '<br />' + timeSyntax );
        var $hello = [];
        $listOfTweets.push($tweet);

        $tweet.appendTo($('.tweets'));
        index -= 1;

        var flag = true;
        for(var i = 0; i < $usernames.length; i++){
          if(tweet.user === $usernames[i]){
            flag = false;
          }
        }
        flag ? $usernames.push(tweet.user) : flag = false;

        // }

        }

        //Add the People to follow section
        $('.suggested').html($('<h2>People to follow</h2>'));


        //Add users to follow list
        function peopleToFollow(){
          for(var j = 0; j < $usernames.length; j++){
            $listFollowers += '<a href="#">@' + $usernames[j] + '</a><br />';
          }
          return $listFollowers;
        }

        //Show new Tweets
        var runtime = 0;
        var interval = setInterval(function(){
          runtime += 1;
          displayTweets();
          if(runtime === 5){
            clearInterval(interval);
            peopleToFollow();
            console.log($usernames);
            console.log($listOfTweets);
            console.log($listOfTweets[0][0]['innerText']);
            $('.suggested').append($listFollowers);
            // $('<button class="more">Show More</button>').appendTo($('.tweets'));
          }
        },1000);

        //Button to show more tweets
        // $('<button class="more">Show More</button>').appendTo($('.tweets'));
        // $('.more').on('click', function(){
        //   $(this).remove();
        //   displayTweets();
        //   $('<button class="more">Show More</button>').appendTo($('.tweets'));
        // });

        //TEST: Create a button that shows more tweets after interval is run
        // $('.more').on('click', function(){
        //   $(this).remove();
        //   runtime = 0;
        //   interval();
        // });


        //click title, changes text in .tweets
        $('#title').on('click', function(){
            $('.tweets').html($listOfTweets[3]);
            clearInterval(interval);
        });


      });
    </script>
  </body>
</html>
